---
import DemoLayout from "@layouts/demo-layout.astro"
import type { GetStaticPaths, InferGetStaticPropsType } from "astro"
import { getCollection, type CollectionEntry } from "astro:content"

export const getStaticPaths = (async () => {
  const allPosts: CollectionEntry<"posts">[] = await getCollection("posts")
  return allPosts.map(post => ({
    params: { slug: post.slug },
    props: { ...post.data, content: post },
  }))
}) satisfies GetStaticPaths

type Props = InferGetStaticPropsType<typeof getStaticPaths>

const { content, date, title, type } = Astro.props
const { slug } = Astro.params
const { Content } = await content.render()
---

<DemoLayout {slug} {title} {date} {type}>
  <Content />
</DemoLayout>
